# 核心类介绍

- [核心类介绍](#核心类介绍)  
  - [BasicBlock](#basicblock)  
  - [Constant](#constant)  
  - [Function](#function)  
  - [GlobalVariable](#globalvariable)  
  - [IRBuilder](#irbuilder)  
  - [Instruction](#instruction)  
  - [Module](#module)  
  - [Type](#type)  
  - [User](#user)  
  - [Value](#value)  
---
## BasicBlock
- 含义：基本块，是一个是单入单出的代码块，该类维护了一个指令链表，基本块本身属于 Value, 类型是 \<label\>，会被分支指令调用
- 成员：
  - instr_list_：指令链表
## Constant
- 继承：User
- 含义：常数，各种类型常量的基类
- 子类：
  - ConstantInt：
    - 含义：int类型的常数
    - 成员：
      - val_：常数值
  - ConstantFP:
    - 含义：float类型的常数
    - 成员：
      - val_：常数值
  - ConstantArray
    - 含义：数组类型的常数
    - 成员：
        - const_array_：数组常量值
        
## Function
- 含义：函数，该类描述 LLVM 的一个简单过程，维护基本块表，格式化参数表
- 成员：
  - basic_blocks_：基本块列表
  - arguments_：参数列表
  - parent_：函数属于的module
- 相关类：
  - Argument：
    - 含义：参数
    - 成员：
      - arg_no_：参数序号
      - parent_：参数属于哪个函数
## GlobalVariable
- 含义：全局变量，该类用于表示全局变量，是 GlobalValue 的子类，根据地址来访问
- 成员：
  - is_const：是否为常量
  - init_val_：初始值
## IRBuilder
- 含义：辅助类建立IR，该类提供了独立的接口创建各种 IR 指令，并将它们插入基本块中
- API：
  - 建立各种指令，会自动挂在setInsertPoint的bb上
## Instruction
- 继承：从User继承
- 含义：指令，该类是所有 LLVM 指令的基类，主要维护指令的操作码（指令类别），指令所属的基本块，指令的操作数个数信息
- 成员：
  - parent_：指令所属的BasicBlock
  - op_id_：指令的类型id
  - num_ops_指令的操作数个数
- 子类：
  - UnaryInst：单目运算指令neg、not（未使用）
  - BinaryInst：双目运算指令包括add、sub、mul、div、rem、and、or
  - CmpInst：比较指令包括gt、ge、lt、le、eq、ne
  - CallInst：调用函数指令
  - BranchInst：分支跳转指令包括条件跳转与强制跳转
  - ReturnInst：返回值指令
  - GetElementPtrInst：取数组指针指令，参数为索引数组和起始地址
  - StoreInst：存储指令
  - LoadInst：访存指令
  - AllocaInst：alloca指令
  - CastInst：zext指令
## Module
- 含义：一个编译单元，在此源语言的意义下是一个文件
- 成员：
  - function_list_：函数链表，记录了这个编译单元的所有函数
  - global_list_：全局变量链表
  - instr_id2string_：通过指令类型id得到其打印的string
  - module_name_, source_file_name：未使用
  - 从module中能取到的基本类型
## Type
- 含义：IR的类型，该类是所有类型的超类
- 成员：
  - tid_：枚举类型，表示type的类型（包含VoidType、LabelType、FloatType、Int1、Int32、ArrayType、PointerType）
- 子类：
  - IntegerType
    - 含义：int 类型
    - 成员：
      - num_bits：长度（i1或者i32）
  - FloatType
    - 含义：float 类型
  - FunctionType
    - 含义：函数类型
    - 成员：
      - result_：返回值类型
      - args_：参数类型列表
  - ArrayType
    - 含义：数组类型
    - 成员：
      - contained_：数组成员的类型
      - num_elements_：数组维数
  - PointerType
    - 含义：指针类型
    - 成员：
      - contained_：指针指向的类型
      
## User
- 继承：从value继承
- 含义：使用者，提供一个操作数表，表中每个操作数都直接指向一个 Value, 提供了 use-def 信息，它本身是 Value 的子类， Value 类会维护一个该数据使用者的列表，提供def-use信息。简单来说操作数表表示我用了谁，该数据使用者列表表示谁用了我。这两个表在后续的优化实验会比较重要请务必理解。
- 成员：
  - operands_：参数列表，表示这个使用者所用到的参数
  - num_ops_：表示该使用者使用的参数的个数

## Value 
- 含义：最基础的类，代表一个操作数，代表一个可能用于指令操作数的带类型数据
- 成员：
  - use_list_：记录了所有使用该操作数的指令的列表
  - name_：名字
  - type_：类型，一个type类，表示操作数的类型
  